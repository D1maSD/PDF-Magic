# PDF Magic

Приложение для управления PDF-документами на iOS, позволяющее создавать, просматривать, объединять и управлять PDF-файлами.

## Назначение приложения

PDF Magic — это полнофункциональное приложение для работы с PDF-документами, которое позволяет:
- Создавать PDF из изображений и файлов
- Просматривать PDF-документы
- Объединять несколько PDF в один документ
- Удалять страницы из PDF
- Сохранять и управлять коллекцией PDF-документов

## Основной функционал

### Создание PDF
- Выбор изображений из галереи устройства
- Выбор файлов (PDF и изображения) через приложение "Файлы"
- Автоматическая конвертация выбранных элементов в единый PDF-документ
- Генерация миниатюр для быстрого просмотра

### Просмотр PDF
- Полноэкранный просмотр PDF-документов
- Навигация по страницам
- Удаление отдельных страниц
- Поделиться PDF через системный Share Sheet
- Сохранение новых документов в коллекцию

### Объединение PDF
- Выбор двух PDF-документов для объединения
- Создание нового документа, содержащего все страницы обоих PDF
- Исходные документы остаются без изменений

### Управление документами
- Список всех сохраненных PDF-документов
- Отображение миниатюр и метаданных
- Удаление документов с удалением файлов
- Контекстное меню для быстрых действий

## Архитектура

Приложение построено на архитектуре **MVVM (Model-View-ViewModel)**:

### Структура проекта

```
PDF Magic/
├── PDF_MagicApp.swift          # Точка входа приложения
├── Views/                       # SwiftUI представления
│   ├── WelcomeView.swift
│   ├── DocumentsListView.swift
│   ├── CreatePDFView.swift
│   ├── PDFReaderView.swift
│   ├── PDFKitView.swift
│   ├── MergePDFView.swift
│   ├── PHPickerView.swift
│   ├── PreviewImageView.swift
│   ├── PreviewFileView.swift
│   ├── NavigationBarModifier.swift
│   ├── ImageWrapper.swift
│   └── URLWrapper.swift
├── ViewModels/                  # Бизнес-логика и состояние
│   ├── WelcomeViewModel.swift
│   ├── DocumentsListViewModel.swift
│   ├── CreatePDFViewModel.swift
│   └── PDFReaderViewModel.swift
├── Services/                    # Сервисный слой
│   └── PDFService.swift
├── Persistence/                  # Работа с данными
│   └── PersistenceController.swift
└── PDFMagicDataModel.xcdatamodeld/  # CoreData модель
    └── PDFMagicDataModel.xcdatamodel/
```

### Принципы архитектуры

- **Views**: Отвечают только за отображение UI, не содержат бизнес-логики
- **ViewModels**: Управляют состоянием и бизнес-логикой, используют сервисы
- **Services**: Независимые сервисы без знания о UI (PDFService работает только с Foundation и PDFKit)
- **Persistence**: Управление CoreData stack и сохранением данных

## Основные технологии

### SwiftUI
- Современный декларативный UI фреймворк
- Навигация через NavigationView (совместимость с iOS 15)
- Использование @StateObject и @Published для реактивности

### CoreData
- Хранение метаданных документов (id, name, fileURL, createdAt, thumbnail)
- **Важно**: PDF-файлы НЕ хранятся в CoreData, только метаданные и пути к файлам
- Автоматическая синхронизация через NSManagedObjectContext

### PDFKit
- Отображение PDF-документов через PDFView
- Создание и модификация PDF через PDFDocument
- Генерация миниатюр из первой страницы PDF

### Foundation & UIKit
- FileManager для работы с файловой системой
- PHPickerViewController для выбора изображений (iOS 14+)
- UIGraphicsPDFRenderer для создания PDF из изображений

## Инструкция по запуску проекта

### Требования
- Xcode 14.0 или новее
- iOS 15.0 или новее
- macOS 12.0 или новее (для разработки)

### Шаги для запуска

1. **Откройте проект**
   ```bash
   cd "PDF Magic"
   open "PDF Magic.xcodeproj"
   ```

2. **Выберите симулятор или устройство**
   - В Xcode выберите целевое устройство (симулятор iPhone или физическое устройство)
   - Убедитесь, что Deployment Target установлен на iOS 15.0

3. **Соберите и запустите проект**
   - Нажмите `Cmd + R` или кнопку "Run" в Xcode
   - Проект должен скомпилироваться без ошибок

4. **Проверка функционала**
   - При первом запуске откроется Welcome Screen
   - Нажмите "Начать" для перехода к списку документов
   - Используйте кнопку "+" для создания нового PDF
   - Выберите документ для просмотра
   - Используйте context menu (long press) для объединения или удаления

### Разрешения

Приложение запрашивает следующие разрешения:
- **Фото**: Для выбора изображений из галереи
- **Файлы**: Для импорта PDF и изображений через приложение "Файлы"

## Особенности реализации

### PDFService
- Полностью независимый от UI сервис
- Работает только с Foundation и PDFKit
- Все методы синхронные
- Не хранит состояние

### Хранение данных
- PDF-файлы сохраняются в Documents directory приложения
- CoreData хранит только метаданные и пути к файлам
- При удалении документа из CoreData удаляется и соответствующий файл

### Обработка ошибок
- Проверка существования файлов перед операциями
- Обработка ошибок чтения/записи PDF
- Информативные сообщения об ошибках для пользователя

## Совместимость

- **Минимальная версия iOS**: 15.0
- **Рекомендуемая версия iOS**: 15.0+
- **Архитектура**: MVVM
- **Навигация**: NavigationView (не NavigationStack для совместимости с iOS 15)

## Лицензия

Этот проект создан в рамках тестового задания.



